var Logger=function(){function n(){}return n.log=function(n){typeof window.console!="undefined"&&window.console.log(n)},n}(),Game29;(function(n){var o=angular.module("game29",["ngCookies","ui.bootstrap"]),r=function(){function n(n,t,i){this.$scope=n,this.$location=t,this.$cookies=i,this._proxy=$.connection.proxy;var r=this;this.registerScopeWatches(),this.registerScopeHandlers(r),this.registerClientCallbacks(),this.startHub(n,r)}return Object.defineProperty(n.prototype,"me",{get:function(){var n=this.$scope.me,i,r;if(!n){if(i=this.$cookies.userEmail,r=this.$cookies.userName,!i)return null;n=new t,n.Name=r,n.Email=i}return n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"room",{get:function(){var n=this.$scope.room,t;if(!n){if(t=this.$location.path().replace("/rooms/",""),!t)return null;n=new i,n.Name=t,this.$scope.room=n}return n},enumerable:!0,configurable:!0}),n.prototype.registerScopeWatches=function(){this.$scope.$watch("room.Name",function(n){n&&this.$location.path("/rooms/"+encodeURIComponent(n))}),this.$scope.$watch("me.Email",function(n){n&&(this.$cookies.userEmail=n)}),this.$scope.$watch("me.Name",function(n){n&&(this.$cookies.userName=n)})},n.prototype.registerScopeHandlers=function(n){this.$scope.closeJoinModal=function(){this.$scope.joinModal=!this.$scope.me.Name||!this.$scope.me.Email,this.$scope.joinRoomModal=!this.$scope.joinModal&&!n.room,this.$scope.joinModal||n.join(),this.$scope.joinRoomModal||n.joinRoom()},this.$scope.closeJoinRoomModal=function(){this.$scope.joinRoomModal=!this.$scope.room.Name,this.$scope.joinRoomModal||n.joinRoom()},this.$scope.leaveRoom=function(){n.leaveRoom(this.user)},this.$scope.leaveTeam=function(){Logger.log("leaveTeam called")},this.$scope.joinModalOptions={backdrop:!1,backdropClick:!1}},n.prototype.startHub=function(n,t){$.connection.hub.start().done(function(){t.me?t.join().done(function(){t.room?t.joinRoom():(n.joinRoomModal=!0,n.$apply())}):(n.joinModal=!0,n.$apply())})},n.prototype.registerClientCallbacks=function(){var n=this;this._proxy.client.userJoined=function(t){return n.userChanged(t)},this._proxy.client.userLeftRoom=function(t){return n.userRemoved(t)},this._proxy.client.trumpOpened=function(){n.$scope.$apply()}},n.prototype.userChanged=function(n){if(this.$scope.room.Users){var t=!1;this.$scope.room.Users=this.$scope.room.Users.map(function(i){return n.Email===i.Email&&(t=!0,i=n),i}),t||this.$scope.room.Users.push(n),this.$scope.$apply()}},n.prototype.userRemoved=function(n){n.Email===this.$scope.me.Email?(this.$scope.room=null,this.$location.path(""),this.$scope.joinRoomModal=!0):(this.$scope.room.Users=this.$scope.room.Users.filter(function(t){return n.Email!==t.Email}),this.$scope.room.Cards=this.$scope.room.Cards.filter(function(t){return n.Email!==t.User.Email})),this.$scope.$apply()},n.prototype.join=function(n){typeof n=="undefined"&&(n=this.me);var t=this;return this._proxy.server.join(n).done(function(n){t.$scope.me=n,t.$scope.$apply()})},n.prototype.joinRoom=function(n){typeof n=="undefined"&&(n=this.room),this.$location.path("/rooms/"+encodeURIComponent(n.Name));var t=this;return this._proxy.server.joinRoom(n).done(function(n){t.$scope.room=n,t.$scope.$apply()})},n.prototype.leaveRoom=function(n){return typeof n=="undefined"&&(n=this.me),null},n.prototype.resetRoom=function(){return null},n.prototype.showAllCards=function(n){return typeof n=="undefined"&&(n=!0),null},n.prototype.changeRoomTopic=function(){return null},n.prototype.changedMyCardValue=function(){return null},n.$inject=["$scope","$location","$cookies"],n}(),t,u,i,f,e,s,h,c,l;n.Game29Ctrl=r,o.controller("Game29Ctrl",r),t=function(){function n(){}return n}(),n.User=t,u=function(){function n(){}return n}(),n.Room=u,i=function(){function n(){}return n}(),n.Game=i,f=function(){function n(){}return n}(),n.Card=f,e=function(){function n(){}return n}(),n.EmoteMessage=e,function(n){n[n.Watcher=0]="Watcher",n[n.TeamA1=1]="TeamA1",n[n.TeamB1=2]="TeamB1",n[n.TeamA2=3]="TeamA2",n[n.TeamB2=4]="TeamB2"}(n.TeamPosition||(n.TeamPosition={})),s=n.TeamPosition,function(n){n[n.Spade=0]="Spade",n[n.Heart=1]="Heart",n[n.Diamond=2]="Diamond",n[n.Club=3]="Club"}(n.SuiteType||(n.SuiteType={})),h=n.SuiteType,function(n){n[n.Jack=0]="Jack",n[n.Nine=1]="Nine",n[n.Ace=2]="Ace",n[n.Ten=3]="Ten",n[n.King=4]="King",n[n.Queen=5]="Queen",n[n.Eight=6]="Eight",n[n.Seven=7]="Seven"}(n.PointCard||(n.PointCard={})),c=n.PointCard,function(n){n[n.Normal=0]="Normal",n[n.Cheers=1]="Cheers",n[n.Congrats=2]="Congrats"}(n.Emote||(n.Emote={})),l=n.Emote})(Game29||(Game29={}))